---
title: 协同过滤
date: 2021-06-20 20:58:51
tags:
---

### 基于用户的协同过滤算法（UserCF)

算法核心：当一个用户A需要个性化推荐时，先找和A相似兴趣的用户，把那些用户喜欢的推荐给用户A

a)找到和目标用户兴趣相似的用户集合

b)找到这个集合中的用户喜欢的，且目标用户没有听说过的物品推荐给目标用户

给定用户$u$,$v$,记$N(u)$为用户$u$给予正反馈的物品集合。

Jaccard公式

- $w_{uv} = \frac{\Sigma_{i\in N(u) \cap N(v)} \frac{1}{log(1+|N(i)|)}}{\sqrt(|N(u)||N(v)|)}$

余弦公式

* $w_{uv} = \frac{|N(u) \cap N(v)|}{\sqrt|N(u)||N(v)|}$

复杂度$O(n^2)$

计算$u$对物品$i$的感兴趣程度

$p(u,i) = \Sigma_{v \in S(u,K)\cap N(i)}w_{uv}r_{vi}$

其中$S(u,K)$包含和用户$u$兴趣最接近的$K$个用户，$N(i)$是对物品$i$有过行为的用户集合，$W_{uv}$是用户$u$与$v$的相似程度，$r_{vi}$是用户$v$对物品$i$的兴趣程度。

### 基于物品的协同过滤算法（ItemCF)

算法思想：给用户推荐那些和他们之前喜欢的物品相似的物品

计算物品之间的相似度

$w_{ij} = \frac{|N(i)\cap N(j)|}{\sqrt|N(i)|| N(j)|} $

根据物品相似度和用户的历史行为给用户生成推荐列表

计算用户$u$对一个物品$j$的兴趣

$p_{uj} = \Sigma_{i\in N(u) \cap S(i,K)} W_{ji}r_{ui}$

$S(i,K)$表示和$i$最相似的$K$个物品集合。

$r_{ui}$表示用户$u$对物品$i$的感兴趣程度

优化：

1）用户活跃度对物品相似度的影响

$w_{ij} = \frac{\Sigma_{u \in N(i)\cap N(j)}\frac{1}{log(1+|N(u)|)}}{\sqrt(|N(i)||N(j)|)}$

2)物品相似度归一化

$w_{ij}' = \frac{w_{ij}}{max_{j}w_{ij}}$

