---
title: 关于本站
date: 2020-08-02 08:23:04
tags: "关于本站"
mathjax: true
---

{% asset_img test.jpg %}

本站诞生史。

<!-- more -->

## hexo 初始化


{% meting "2909007895" "netease" "playlist" %}



```
hexo init
npm install
npm install hexo-deployer-git --save
hexo clean
hexo g -d
hexo s -d
```

## 安装next主题

最新next仓库
https://github.com/next-theme/hexo-theme-next

```
git clone https://github.com/next-theme/hexo-theme-next themes/next
```
## 文本添加音乐

### 安装hexo-tag-aplayer

```
npm install --save hexo-tag-aplayer
```

### 使用
```
{% aplayer title author url [picture_url, narrow, autoplay, width:xxx, lrc:xxx] %}
```

参数：

title : 曲目标题

author: 曲目作者

url: 音乐文件 URL 地址

picture_url: (可选) 音乐对应的图片地址

narrow: （可选）播放器袖珍风格

autoplay: (可选) 自动播放，移动端浏览器暂时不支持此功能

width:xxx: (可选) 播放器宽度 (默认: 100%)

lrc:xxx: （可选）歌词文件 URL 地址

当开启 Hexo 的 文章资源文件夹 功能时，可以将图片、音乐文件、歌词文件放入与文章对应的资源文件夹中，然后直接引用：

```
{% aplayer "Caffeine" "Jeff Williams" "caffeine.mp3" "picture.jpg" "lrc:caffeine.txt" %}
```

#### 播放列表
```
{% aplayerlist %}
{
    "narrow": false,                          // （可选）播放器袖珍风格
    "autoplay": true,                         // （可选) 自动播放，移动端浏览器暂时不支持此功能
    "mode": "random",                         // （可选）曲目循环类型，有 'random'（随机播放）, 'single' (单曲播放), 'circulation' (循环播放), 'order' (列表播放)， 默认：'circulation' 
    "showlrc": 3,                             // （可选）歌词显示配置项，可选项有：1,2,3
    "mutex": true,                            // （可选）该选项开启时，如果同页面有其他 aplayer 播放，该播放器会暂停
    "theme": "#e6d0b2",	                      // （可选）播放器风格色彩设置，默认：#b7daff
    "preload": "metadata",                    // （可选）音乐文件预载入模式，可选项： 'none' 'metadata' 'auto', 默认: 'auto'
    "listmaxheight": "513px",                 // (可选) 该播放列表的最大长度
    "music": [
        {
            "title": "CoCo",
            "author": "Jeff Williams",
            "url": "caffeine.mp3",
            "pic": "caffeine.jpeg",
            "lrc": "caffeine.txt"
        },
        {
            "title": "アイロニ",
            "author": "鹿乃",
            "url": "irony.mp3",
            "pic": "irony.jpg"
        }
    ]
}
{% endaplayerlist %}
```
#### MetingJS支持
如果想在本插件中使用 MetingJS，请在 Hexo 配置文件 _config.yml 中设置：
```
aplayer:
  meting: true
```
接着就可以通过 
```
{% meting ...%}
```
 在文章中使用 MetingJS 播放器了：
```
<!-- 简单示例 (id, server, type)  -->
{% meting "60198" "netease" "playlist" %}

<!-- 进阶示例 -->
{% meting "60198" "netease" "playlist" "autoplay" "mutex:false" "listmaxheight:340px" "preload:none" "theme:#ad7a86"%}
```

id	必须值	歌曲 id / 播放列表 id / 相册 id / 搜索关键字

server	必须值	音乐平台: netease, tencent, kugou, xiami, baidu

type	必须值	song, playlist, album, search, artist

fixed	false	开启固定模式

mini	false	开启迷你模式

loop	all	列表循环模式：all, one,none

order	list	列表播放模式： list, random

volume	0.7	播放器音量

lrctype	0	歌词格式类型

listfolded	false	指定音乐播放列表是否折叠

storagename	metingjs	LocalStorage 中存储播放器设定的键名

autoplay	true	自动播放，移动端浏览器暂时不支持此功能

mutex	true	该选项开启时，如果同页面有其他 aplayer 播放，该播放器会暂停

listmaxheight	340px	播放列表的最大长度

preload	auto	音乐文件预载入模式，可选项： none, metadata, auto

theme	#ad7a86	播放器风格色彩设置

## 全局音乐自动播放


修改<font color=red>\theme\next\layout\_layout.swig</font>文件


```
<!-- 引用依赖 -->
<link rel="stylesheet" 
  href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script>

<!-- 我使用的APlayer本体 -->
<div class="aplayer" 
  data-id="2465890057" 
  data-server="netease" 
  data-type="playlist" 
  data-fixed="true" 
  data-autoplay="true" 
  data-order="random" 
  data-volume="0.55" 
  data-theme="#cc543a" 
  data-preload="auto" >
  </div>
<!--如果将本体放在body里面导致页面加载出现问题，请尝试放到body体后面-->
```

Aplayer[参数设置](https://github.com/metowolf/MetingJS)
```
data-server: netease, tencent, kugou, xiami, baidu
data-type: song, playlist, album, search, artist
data-id: song id / playlist id / album id / search keyword
data-order: 'list', 'random'
```



<font color=red>pjax</font>，页面跳转时不重新播放

pjax安装

```
$ cd themes/next
$ git clone https://github.com/theme-next/theme-next-pjax source/lib/pjax
```

设置theme的_config.yml
```
# Easily enable fast Ajax navigation on your website.
# Dependencies: https://github.com/theme-next/theme-next-pjax
# For moreinformation: https://github.com/MoOx/pjax
pjax: true
```

## 设置背景图片


修改theme _config.yml
```
custom_file_path:
  style: source/_data/styles.styl
```
在<font color=red>blog根目录下</font>新建_data文件夹

新建styles.styl

内容：
```
// 添加背景图片
body {
      background: url(https://source.unsplash.com/random/1600x900?wallpapers);//自己喜欢的图片地址
      background-size: cover;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-position: 50% 50%;
}
.main-inner {
   // margin-top: 60px;
   // padding: 60px 60px 60px 60px;

    opacity: 0.8;
}

//博客内容透明化
//文章内容的透明度设置

.content-wrap {
  opacity: 0.85;
}

//侧边框的透明度设置
.sidebar {
  opacity: 0.85;
}

//菜单栏的透明度设置
.header-inner {
  background: rgba(255,255,255,0.85);
}

//搜索框（local-search）的透明度设置
.popup {
  opacity: 0.85;
}
```


## 本地搜索

安装相应插件
```
npm install hexo-generator-searchdb  --save
```
设置根目录配置文件
```
search:
  path: search.xml
  field: post
  content: true
  format: html
```

设置主题目录配置文件
```
local_search:
  enable: true
  # If auto, trigger search by changing input.
  # If manual, trigger search by pressing enter key or search button.
  trigger: auto
  # Show top n results per article, show all results by setting to -1
  top_n_per_article: 5
  # Unescape html strings to the readable one.
  unescape: false
  # Preload the search data when the page loads.
  preload: false
```

## 数学公式

### 安装 hexo-renderer-kramed 
```
npm uninstall hexo-renderer-marked --save
npm install hexo-renderer-kramed --save
```

### 修改/node_modules/kramed/lib/rules/inline.js
```
escape: /^\\([\\`*{}\[\]()#$+\-.!_>])/,
改为
escape: /^\\([`*\[\]()# +\-.!_>])/,

em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,
改为
em: /^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,
```

### 修改主题_config.yml
```
math:
  per_page: true 
  mathjax:
    enable: true
    mhchem: false
```
开启per_page保证只要显示加了mathjax: true的页面才进行渲染。

### 在md文件开启mathjax
```
mathjax: true
```

### 使用 MathJax 给公式编号并引用公式

在新版本的 NexT 主题中，我们加入了公式自动编号和引用功能。下面简要介绍一下如何使用这项功能。

为了使用这项功能，一般来说，你必须把所使用的 LaTeX 公式放在 equation 环境里面，采用旧的方法
（也就是说，仅仅把公式的每一边用两个 $ 符号包含起来）是无效的。如何引用公式？
你只需要在书写公式的时候给公式一个 \label{} 标记（tag），然后在正文中，可以使用 \\ref{} 或者 \\eqref{} 命令来引用对应的公式。
使用 \\eqref{} 是推荐的方式，因为如果你使用 \\ref{}，公式在文中的引用编号将没有圆括号包围。下面介绍几种常见的公式编号例子。

对于简单的公式，使用下面的方式给公式一个标记，

```
$$\begin{equation}\label{eq1}
e=mc^2
\end{equation}$$
```
然后，在正文中，你可以轻松引用上述公式，一个简单的例子如下：
```
著名的质能方程 $\eqref{eq1}$ 由爱因斯坦提出 ...
```

$$\begin{equation}\label{eq1}
e=mc^2
\end{equation}$$

著名的质能方程 $\eqref{eq1}$ 由爱因斯坦提出 ...

对于多行公式，在 equation 环境中，你可以使用 aligned 环境把公式分成多行，
```
$$\begin{equation}\label{eq2}
\begin{aligned}
a &= b + c \\
  &= d + e + f + g \\
  &= h + i
\end{aligned}
\end{equation}$$
```

$$\begin{equation}\label{eq2}
\begin{aligned}
a &= b + c \\
  &= d + e + f + g \\
  &= h + i
\end{aligned}
\end{equation}$$


要对齐多个公式，我们需要使用 align 环境。align 环境中的每个公式都有自己的编号：
```
$$\begin{align}
a &= b + c \label{eq3} \\
x &= yz \label{eq4}\\
l &= m - n \label{eq5}
\end{align}$$
```

$$\begin{align}
a &= b + c \label{eq3} \\
x &= yz \label{eq4}\\
l &= m - n \label{eq5}
\end{align}$$


在 align 环境中，如果你不想给某个或某几个公式编号，那么在这些公式后面使用 \nonumber 命令即可。例如：
```
$$\begin{align}
-4 + 5x &= 2+y \nonumber  \\
 w+2 &= -1+w \\
 ab &= cb
\end{align}$$
```

$$\begin{align}
-4 + 5x &= 2+y \nonumber  \\
 w+2 &= -1+w \\
 ab &= cb
\end{align}$$

有时，你可能会希望采用更加奇特的方式来标记和引用你的公式，你可以通过使用 \tag{} 命令来实现，例如：
```
$$x+1\over\sqrt{1-x^2} \tag{i}\label{eq_tag}$$
```

$$x+1\over\sqrt{1-x^2} \tag{i}\label{eq_tag}$$

## 文章加密

安装插件
```
npm install --save hexo-blog-encrypt
```
格式
```
---
title: Hello World
tags:
- encryptAsDiary
date: 2016-03-30 21:12:21
password: mikemessi
abstract: Here's something encrypted, password is required to continue reading.
message: Hey, password is required here.
wrong_pass_message: Oh, this is an invalid password. Check and try again, please.
wrong_hash_message: Oh, these decrypted content cannot be verified, but you can still have a look.
---
```

## 其他

### 添加看板娘

```
npm install --save hexo-helper-live2d
```
https://github.com/xiazeyu/live2d-widget-models

### 禁用评论
md文件加
```
comments: false
```

### 文章置顶
```
npm uninstall hexo-generator-index --save
npm install hexo-generator-index-pin-top --save
文章内设置：
top: true
```

修改/themes/next/layout/_macro/post.swig,在

```
<div class="post-meta">
```

标签下，插入如下代码：

```
{% if post.top %}
    <i class="fa fa-thumb-tack"></i>
    <font color="green">置顶</font>
    <span class="post-meta-divider">|</span>
{% endif %}
```

### 首页不显示全文
```
<!-- more -->
```
### 替换标签前缀 # 字符

主题_config.yml
```
tag_icon: true
```
### markdown改变字体颜色
```
改变颜色 <font color=red>text</font>
改变字体 <font face="微软雅黑">微软雅黑</font>
改变大小 <font color=red size=12>字号12</font>
改变背景色 <table><tr><td bgcolor=orange>背景色是：orange</td></tr></table>
```

### markdown插入超链接
```
[提示文字](url)
```

### 插入图片
```
{% asset_img test.jpg %}
//test.jpg在对应资源文件夹
```

一些图片网站

https://pixabay.com/images/search/

https://unsplash.com/

https://www.pexels.com/zh-cn/

### 鼠标特效

在themes\next\source\js目录下新建fire.js,内容如下：
```
class Circle {
  constructor({ origin, speed, color, angle, context }) {
    this.origin = origin
    this.position = { ...this.origin }
    this.color = color
    this.speed = speed
    this.angle = angle
    this.context = context
    this.renderCount = 0
  }

  draw() {
    this.context.fillStyle = this.color
    this.context.beginPath()
    this.context.arc(this.position.x, this.position.y, 2, 0, Math.PI * 2)
    this.context.fill()
  }

  move() {
    this.position.x = (Math.sin(this.angle) * this.speed) + this.position.x
    this.position.y = (Math.cos(this.angle) * this.speed) + this.position.y + (this.renderCount * 0.3)
    this.renderCount++
  }
}

class Boom {
  constructor ({ origin, context, circleCount = 16, area }) {
    this.origin = origin
    this.context = context
    this.circleCount = circleCount
    this.area = area
    this.stop = false
    this.circles = []
  }

  randomArray(range) {
    const length = range.length
    const randomIndex = Math.floor(length * Math.random())
    return range[randomIndex]
  }

  randomColor() {
    const range = ['8', '9', 'A', 'B', 'C', 'D', 'E', 'F']
    return '#' + this.randomArray(range) + this.randomArray(range) + this.randomArray(range) + this.randomArray(range) + this.randomArray(range) + this.randomArray(range)
  }

  randomRange(start, end) {
    return (end - start) * Math.random() + start
  }

  init() {
    for(let i = 0; i < this.circleCount; i++) {
      const circle = new Circle({
        context: this.context,
        origin: this.origin,
        color: this.randomColor(),
        angle: this.randomRange(Math.PI - 1, Math.PI + 1),
        speed: this.randomRange(1, 6)
      })
      this.circles.push(circle)
    }
  }

  move() {
    this.circles.forEach((circle, index) => {
      if (circle.position.x > this.area.width || circle.position.y > this.area.height) {
        return this.circles.splice(index, 1)
      }
      circle.move()
    })
    if (this.circles.length == 0) {
      this.stop = true
    }
  }

  draw() {
    this.circles.forEach(circle => circle.draw())
  }
}

class CursorSpecialEffects {
  constructor() {
    this.computerCanvas = document.createElement('canvas')
    this.renderCanvas = document.createElement('canvas')

    this.computerContext = this.computerCanvas.getContext('2d')
    this.renderContext = this.renderCanvas.getContext('2d')

    this.globalWidth = window.innerWidth
    this.globalHeight = window.innerHeight

    this.booms = []
    this.running = false
  }

  handleMouseDown(e) {
    const boom = new Boom({
      origin: { x: e.clientX, y: e.clientY },
      context: this.computerContext,
      area: {
        width: this.globalWidth,
        height: this.globalHeight
      }
    })
    boom.init()
    this.booms.push(boom)
    this.running || this.run()
  }

  handlePageHide() {
    this.booms = []
    this.running = false
  }

  init() {
    const style = this.renderCanvas.style
    style.position = 'fixed'
    style.top = style.left = 0
    style.zIndex = '999999999999999999999999999999999999999999'
    style.pointerEvents = 'none'

    style.width = this.renderCanvas.width = this.computerCanvas.width = this.globalWidth
    style.height = this.renderCanvas.height = this.computerCanvas.height = this.globalHeight

    document.body.append(this.renderCanvas)

    window.addEventListener('mousedown', this.handleMouseDown.bind(this))
    window.addEventListener('pagehide', this.handlePageHide.bind(this))
  }

  run() {
    this.running = true
    if (this.booms.length == 0) {
      return this.running = false
    }

    requestAnimationFrame(this.run.bind(this))

    this.computerContext.clearRect(0, 0, this.globalWidth, this.globalHeight)
    this.renderContext.clearRect(0, 0, this.globalWidth, this.globalHeight)

    this.booms.forEach((boom, index) => {
      if (boom.stop) {
        return this.booms.splice(index, 1)
      }
      boom.move()
      boom.draw()
    })
    this.renderContext.drawImage(this.computerCanvas, 0, 0, this.globalWidth, this.globalHeight)
  }
}

const cursorSpecialEffects = new CursorSpecialEffects()
cursorSpecialEffects.init()

```

在themes\next\layout的layout.njk下添加
```
<script type="text/javascript" src="/js/fire.js"></script>
```

### 自定义回到顶部

在source\images目录下放入自定义scroll.png，然后在source\_data\styles.styl增加

```
//自定义回到顶部样式
.back-to-top {
  right: 60px;
  width: 70px;  //图片素材宽度
  height: 900px;  //图片素材高度
  top: -900px;
  bottom: unset;
  transition: all .5s ease-in-out;
  background: url("/images/scroll.png");

  //隐藏箭头图标
  > i {
    display: none;
  }

  &.back-to-top-on {
    bottom: unset;
    top: 100vh < (900px + 200px) ? calc( 100vh - 900px - 200px ) : 0px;
  }
}
```